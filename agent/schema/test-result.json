{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "AI-Ready Data Assessment Test Result",
  "description": "Schema for individual test results produced by the assessment agent. Every test, regardless of factor, platform, or query provider, produces this shape.",
  "type": "object",
  "required": ["factor", "requirement", "target", "levels", "result", "measured_value", "thresholds", "detail", "query", "requires"],
  "properties": {
    "factor": {
      "type": "string",
      "enum": ["clean", "contextual", "consumable", "current", "correlated", "compliant"],
      "description": "Which of the five factors this test assesses."
    },
    "requirement": {
      "type": "string",
      "description": "The specific requirement being tested (e.g., null_handling, deduplication, pii_redaction)."
    },
    "target": {
      "type": "string",
      "description": "The fully qualified target: database.schema.table or database.schema.table.column."
    },
    "levels": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["L1", "L2", "L3"]
      },
      "description": "Which workload levels this test is relevant to."
    },
    "result": {
      "type": "object",
      "properties": {
        "L1": { "type": "string", "enum": ["pass", "fail", "skip"] },
        "L2": { "type": "string", "enum": ["pass", "fail", "skip"] },
        "L3": { "type": "string", "enum": ["pass", "fail", "skip"] }
      },
      "description": "Pass/fail verdict at each workload level. 'skip' when the test is not relevant at that level."
    },
    "measured_value": {
      "type": ["number", "null"],
      "description": "The measured value from the query. Null if the query could not be executed."
    },
    "thresholds": {
      "type": "object",
      "properties": {
        "L1": { "type": ["number", "null"] },
        "L2": { "type": ["number", "null"] },
        "L3": { "type": ["number", "null"] }
      },
      "description": "Threshold values at each level. Null when the test is not relevant at that level."
    },
    "detail": {
      "type": "string",
      "description": "Human-readable explanation of the result."
    },
    "query": {
      "type": "string",
      "description": "The exact SQL query that was executed to produce the measurement."
    },
    "requires": {
      "type": "string",
      "description": "The query provider tag (e.g., ansi-sql, information-schema, snowflake, iceberg-rest, otel)."
    }
  }
}
